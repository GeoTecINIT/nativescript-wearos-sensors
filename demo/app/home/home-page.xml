<Page
    navigatingTo="onNavigatingTo"
    xmlns="http://schemas.nativescript.org/tns.xsd">

    <ActionBar>
        <Label text="WearOS Sensors"></Label>
    </ActionBar>
    <StackLayout>
        <StackLayout orientation="horizontal" style="horizontal-align: center">
            <Label text="Wear Sensor:"
                   class="v-centered bold"
                   style="margin-right: 20dp; font-size: 20dp"/>
            <ListPicker items="{{ sensors }}"
                        loaded="{{ onListPickerLoaded }}"
                        selectedValue="{{ selectedSensor }}" width="150dp"/>
        </StackLayout>

        <GridLayout columns="*, *" rows="auto, auto, auto, auto" horizontalAlignment="center" width="100%">
            <!-- Add your page content here -->
            <Button row="0" col="0" text="Send isReady" tap="{{ onIsReadyTap }}"
                    class="bg-primary -rounded-lg"></Button>
            <Button row="1" col="0" text="Send prepare" tap="{{ onPrepareTap }}"
                    isEnabled="{{ needToPrepare }}"
                    class="bg-primary -rounded-lg"></Button>
            <Button row="2" col="0" text="Send start" tap="{{ onStartTap }}"
                    isEnabled="{{ isDeviceReady }}"
                    class="bg-primary -rounded-lg"></Button>
            <Button row="2" col="1" text="Send stop" tap="{{ onStopTap }}"
                    isEnabled="{{ isDeviceReady }}"
                    class="bg-primary -rounded-lg"></Button>
            <Button row="3" col="0" colSpan="2" text="Clear nodes" tap="{{ onClearNodesTap }}"
                    class="bg-danger -rounded-lg"></Button>

            <Label class="v-centered h-centered" row="0" col="1" text="{{ readyResponse }}"></Label>
            <ActivityIndicator row="0" col="1" visibility="{{ waitingForIsReadyResponse ? 'visible' : 'collapsed' }}" busy="true"/>
            <Label class="v-centered h-centered" row="1" col="1" textWrap="true" text="{{ prepareResponse }}"></Label>
            <ActivityIndicator row="1" col="1" visibility="{{ waitingForPrepareResponse ? 'visible' : 'collapsed' }}" busy="true"/>
        </GridLayout>

        <StackLayout visibility="{{ started ? 'visible' : 'collapsed' }}">
            <ActivityIndicator visibility="{{ receivedRecords ? 'collapsed' : 'visible' }}"
                               marginTop="20dp"
                               width="100dp"
                               height="100dp"
                               busy="true"/>
            <GridLayout class="bordered-layout" columns="*, *" rows="auto, auto, auto" visibility="{{ receivedRecords ? 'visible' : 'collapsed'}}">
                <Label class="h-centered bold" row="0" col="0" colSpan="2" text="Received records"></Label>
                <Label class="h-centered" row="1" col="0" text="{{ receivedRecords, 'Type: ' + receivedRecords.type }}"></Label>
                <Label class="h-centered" row="1" col="1" text="{{ receivedRecords, 'Batch size: ' + receivedRecords.batchSize }}"></Label>
                <StackLayout row="2" col="0" colSpan="2"
                            visibility="{{ receivedRecords, receivedRecords.type === 'LOCATION' ? 'visible' : 'collapsed'}}">
                    <Label text="{{ receivedRecords, 'Timestamp: ' + receivedRecords.record.timestamp }}" textWrap="true"></Label>
                    <Label text="{{ receivedRecords, 'Latitude: ' + receivedRecords.record.latitude }}"></Label>
                    <Label text="{{ receivedRecords, 'Longitude: ' + receivedRecords.record.longitude }}"></Label>
                    <Label text="{{ receivedRecords, 'Altitude: ' + receivedRecords.record.altitude }}"></Label>
                </StackLayout>
                <StackLayout row="2" col="0" colSpan="2"
                             visibility="{{ receivedRecords, receivedRecords.type === 'HEART_RATE' ? 'visible' : 'collapsed'}}">
                    <Label text="{{ receivedRecords, 'Timestamp: ' + receivedRecords.record.timestamp }}" textWrap="true"></Label>
                    <Label text="{{ receivedRecords, 'HR value: ' + receivedRecords.record.value }}"></Label>
                </StackLayout>
                <GridLayout row="2" col="0" columns="*, 4*" rows="auto, auto, auto, auto"
                            visibility="{{ receivedRecords.first ? 'visible' : 'collapsed'}}">
                    <Label class="bold" row="0" col="0" rowSpan="4" text="First:"></Label>
                    <Label row="0" col="1" text="{{ receivedRecords, 'Timestamp: ' + receivedRecords.first.timestamp }}" textWrap="true"></Label>
                    <Label row="1" col="1" text="{{ receivedRecords, 'x: ' + receivedRecords.first.x }}"></Label>
                    <Label row="2" col="1" text="{{ receivedRecords, 'y: ' + receivedRecords.first.y }}"></Label>
                    <Label row="3" col="1" text="{{ receivedRecords, 'z: ' + receivedRecords.first.z }}"></Label>
                </GridLayout>
                <GridLayout row="2" col="1" columns="*, 4*" rows="auto, auto, auto, auto"
                            visibility="{{ receivedRecords.first ? 'visible' : 'collapsed'}}">
                    <Label class="bold" row="0" col="0" rowSpan="4" text="Last:"></Label>
                    <Label row="0" col="1" text="{{ receivedRecords, 'Timestamp: ' + receivedRecords.last.timestamp }}" textWrap="true"></Label>
                    <Label row="1" col="1" text="{{ receivedRecords, 'x: ' + receivedRecords.last.x }}"></Label>
                    <Label row="2" col="1" text="{{ receivedRecords, 'y: ' + receivedRecords.last.y }}"></Label>
                    <Label row="3" col="1" text="{{ receivedRecords, 'z: ' + receivedRecords.last.z }}"></Label>
                </GridLayout>
            </GridLayout>
        </StackLayout>

        <StackLayout class="bordered-layout" visibility="{{ prepareErrors ? 'visible' : 'collapsed' }}">
            <Label class="h-centered bold" text="Prepare errors"></Label>
            <StackLayout orientation="horizontal">
                <Label class=" bold" text="Message: "></Label>
                <Label textWrap="true" text="{{ prepareErrors }}"></Label>
            </StackLayout>
        </StackLayout>
    </StackLayout>
</Page>
